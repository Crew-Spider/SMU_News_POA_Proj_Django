* * 　 　 编辑 点评 ： 云 计算 的 发展 给 高校 目前 带来 的 最 主要 的 服务 模式 的 变更 在于 IaaS ， 但是 这 只是 原先 主机 交付 与 虚拟机 交付 的 差别 ， 还 未 升级 到 对 软件 交付 模式 进行 改进 的 高层次 变更 。 为了 改进 高校 软件 交付 的 模式 ， 上海 海事 大学 在 近两年 的 软件系统 建设 中 ， 优先 采用 DevOps 模式 ， 对 其他 学校 很 有 参考价值 。 * * * * 　 DevOps 介绍 * * 随着 信息化 的 发展 ， 高校 各类 业务 系统 数目 繁多 ， 而 软件 交付 的 方式 也 在 发生变化 。 传统 的 软件系统 交付 方式 是 由 校方 信息化 管理 部门 提供 硬件 服务器 ， 只 负责 服务器 硬件资源 的 正常 运转 和 网络 访问 的 畅通 ， 而 不 参与 到 软件开发 生命周期 。 这种 方式 在 高校 信息化 发展 初期 确实 非常 高效 ， 也 弥补 了 校方 人员 技术水平 不高 的 缺陷 。 但是 随着 信息化 的 发展 ， 云 计算技术 的 成熟 ， 大 数据 对 教育 的 变革 ， 尤其 是 高校 信息化 需求 的 变化 ， 各个 应用 不再 是 独立 的 个体 ， 而是 整个 学校 信息化 的 组件 ， 多个 应用 之间 相辅相成 ， 业务流程 交叉 ， 数据流 混杂 。 软件系统 个体 发展 开始 向 平台 化 、 集成化 、 统一化 发展 。 这种 变化 ， 对于 软件开发 参与者 发生 了 变化 ， 对 校方 信息化 人员 的 总体 战略 和 运维 也 提出 了 更 高 的 要求 。 这些 变化 ， 要求 校方 信息化 人员 与 第三方 软件 供应商 协同工作 ， 参与 系统 部署 的 环境 准备 和 后续 运维 。 DevOps （ Development 和 Operations 的 组合 词 ） 是 一种 重视 “ 软件 开发人员 （ Dev ） ” 和 “ IT 运维 技术人员 （ Ops ） ” 之间 沟通 合作 的 文化 、 运动 或 惯例 。 透过 自动化 “ 软件 交付 ” 和 “ 架构 变更 ” 的 流程 ， 来 使得 构建 、 测试 、 发布 软件 能够 更加 地 快捷 、 频繁 和 可靠 。 它 的 出现 是 由于 软件 行业 日益 清晰 认识 到 ： 为了 按时 交付 软件产品 和 服务 ， 开发 和 运营 必须 紧密 合作 。 如图 1 所示 ， 我们 可以 把 DevOps 看作 开发 （ 软件工程 ） 、 技术 运营 和 质量 保障 （ QA ） 三者 的 交集 传统 的 软件 组织 将 开发 、 IT 运营 和 质量 保障 设 为 各自 分离 的 部门 ， 在 这种 环境 下 如何 采用 新 的 开发方法 （ 例如 敏捷 软件开发 ） ， 是 一个 重要 的 课题 。 按照 从前 的 工作 方式 ， 开发 和 部署 ， 不 需要 IT 支持 或者 QA 深入 的 跨部门 的 支持 ； 而 现在 却 需要 极其 紧密 的 多 部门 协作 。 而 DevOps 考虑 的 还 不止 是 软件 部署 ， 它 是 一套 针对 这 几个 部门 间 沟通 与 协作 问题 的 流程 和 方法 。 ! [ ] ( . / W020161208674549509405 . jpg ) DevOps 的 引入 能 对 产品 交付 、 测试 、 功能 开发 和 维护 起到 意义 深远 的 影响 。 在 缺乏 DevOps 能力 的 组织 中 ， 开发 与 运营 之间 存在 着 信息 “ 鸿沟 ” ─ ─ 例如 运营 人员 要求 更好 的 可靠性 和 安全性 ， 开发人员 则 希望 基础设施 响应 更 快 ， 而 业务 用户 的 需求 则 是 更 快 地 将 更 多 的 特性 发布 给 最终用户 使用 。 这种 信息 鸿沟 就是 最常出 问题 的 地方 。 　 　 * * 云 计算技术 的 发展 与 局限性 * * 按照 IDC 的 研究 ， 2005 年 之前 是 虚拟化 技术 发展 的 第一阶段 ， 称之为 虚拟化 1.0 ， 从 2005 年 到 2010 年时 虚拟化 发展 的 第二阶段 ， 称之为 虚拟化 2.0 ， 目前 已经 进入 虚拟化 2.5 阶段 ， 虚拟化 3.0 阶段 在 不久 也 将 会 到来 。 根据 Gartner 的 预测 ， 目前 中国 70 % 的 X86 企业 服务器 将 实现 虚拟化 。 而 高校 核心 机房 的 虚拟化 发展 更是如此 ， 几乎 每个 高校 都 在 利用 虚拟化 部署 应用 系统 ， 每个 高校 部署 了 私有 云 。 CPU 的 虚拟化 技术 将 计算能力 作为 资源 ， VxLAN 技术 将 网络 作为 资源 ， 而 各种 分布式文件系统 则 将 存储 作为 资源 。 以上 几种 资源 都 可以 通过 私有 云来 进行 自助 申请 、 使用 以及 归还 。 目前 IaaS 在 高校 云 计算 中 得到 了 实现 和 部署 ， 信息化 部门 可以 使用 商业 虚拟化 软件 管理 各类 虚拟化 资源 ， 并 允许 用户 自助 申请 。 但 IaaS 的 可 分配 的 资源 粒度 限定 于 虚拟机 ， 还 未能 细化 到 服务 。 PaaS 技术 则 更加 侧重于 某个 开发 平台 所用 组件 为 服务 ， 譬如 数据库 作为 服务 ， 或者 一整套 开发 环境 作为 服务 ， 这种 模式 强调 的 是 服务 的 可 重用 性 ， 高校 信息化 的 多样性 决定 了 这种 模式 在 高校 中 的 局限性 。 SaaS 是 更 高端 的 服务 模式 ， 所以 云 计算 的 发展 给 高校 带来 的 最 主要 的 服务 模式 的 变更 在于 IaaS ， 这 只是 原先 主机 交付 与 虚拟机 交付 的 差别 ， 还 未 升级 到 对 软件 交付 模式 进行 改进 的 高层次 变更 。 　 　 * * 高校 云 计算环境 下 的 DevOps 实践 * * 为了 改进 高校 软件 交付 的 模式 ， 我们 在 近两年 的 软件系统 建设 中 ， 优先 采用 DevOps 模式 ， 校内 项目 负责 人员 、 运维 人员 和 第三方 软件 开发商 人员 进行 了 对接 ， 组建 新 形式 的 项目组 ， 共同 参与 项目 建设 。 双方 职责 因 分工 不同 而 侧重点 不同 。 在 项目 建设 中 引入 了 敏捷 开发方法 ， 并且 要求 产品 多次 交付 ， 具体措施 有 ： 　 　 使用 敏捷 或 其他 软件开发 过程 与 方法 ； 　 　 校方 要求 产品 分阶段 多次 交付 ， 提高 产品 交付 的 速率 ； 　 　 完善 虚拟化 和 云 计算 基础设施 ， 保障 产品开发 运行 环境 ； 　 　 数据中心 拥有 自动化 技术 和 配置管理 工具 。 有 了 这 几项 措施 ， DevOps 增进 了 开发 团队 与 运营 团队 之间 的 协作性 、 高效性 的 关系 。 由于 团队 间 协作关系 的 改善 ， 整个 组织 的 效率 因此 得到 提升 ， 伴随 频繁 变化 而来 的 生产 环境 的 风险 也 能 得到 降低 ， 并且 降低 了 软件产品 开发 失败 的 风险 。 图 2 为 DevOps 的 生命周期 路线 。 ! [ ] ( . / W020161208674549643288 . jpg ) 为了 正确 使用 DevOps 模式 ， 在 软件架构 中 ， 引入 了 微 服务 ， 并 根据 基于 业务 进行 拆分 、 采用 自动化 文化 、 去 中心化 、 服务 独立 部署 、 服务 完全 自治 、 隔离 失败 、 渐进式 拆分 、 避免 大规模 改造 原有 代码 等 原则 对 业务 进行 拆分 。 　 　 结合 我们 具体 的 实践 ， 现 总结 一下 在 实践 DevOps 模式 时 需要 执行 的 步骤 。 　 　 1 . 操作系统 的 限定 　 　 目前 常用 的 服务器 操作系统 有 WindowsServer 和 Linux ， 而 软件 普遍 采用 B / S 架构 ， 因此 对于 操作系统 的 需求 ， 主要 是 为了 能够 运行 Web 服务器 ， 考虑 到 目前 常用 Web 服务器 有 微软 的 IIS ， Apachehttpd ， Nginx ， 我们 只 需要 准备 Windows   Server2012 和 CentOS 等 Linux 系统 即可 。 由于 我们 限定 了 操作系统 ， 开发 组也会 提早 获知 生产 运行 环境 ， 改变 以往 软件 完成 后 ， 校方 必须 满足 软件开发 方 的 需求 ， 造成 了 多种 操作系统 的 存在 。 　 　 2 . 数据库 的 限定 现有 编程语言 ， 都 有 成熟 的 数据 持久 化 工具 ， 而 数据 持久 化 工具 对于 数据库 是 透明 的 ， 它 依赖于 数据 驱动程序 ， 允许 用户 比较 容易 的 在 多种 数据库 软件 中 迁移 和 部署 ， 因此 数据库 可 由 校方 自主 选择 决定 。 比较 常见 的 数据库 有 Oracle 、 MicrosoftSQL   Server 和 MySQL 。 其中 Oracle 基本 是 采取 独立 于 软件 部署 服务器 的 方式 提供 ， Microsoft   SQLServer 和 MySQL 因为 是 轻量级 的 数据库 服务 系统 ， 可以 视 软件系统 的 复杂性 决定 是否 与 软件 部署 在 相同 的 服务器 中 。 　 　 操作系统 和 数据库 的 决定 ， 为 我们 准备 虚拟机 模板 提供 了 依据 。 在 DevOps 实践 中 ， 我们 根据 上面 几个 选项 ， 分别 构建 了 WindowsServer + Microsoft   SQLServer 和 CentOS + MySQL 的 模板 ， 并 让 开发 方 实现 知情 未来 的 生产 环境 ， 开发 方在 需求 调研 阶段 依然 获知 未来 的 运行 环境 ， 有 针对性 的 开发 ， 提高 了 后续 产品 的 稳定性 。 　 　 3 . Web 服务器 的 选择 　 　 对于 Java 类 开发 语言 ， 对 Web 服务器 的 依赖性 不 强 ， 反而 是 需要 成熟 的 容器 ， 如 Tomcat 、 Glassfish 、 WebLogicServer 等 容器 。 这 一方面 的 选择 根据 操作系统 以及 Java 平台 架构 限定 。 若 是 轻量级 的 应用 ， 可以 选用 Tomcat 容器 ， 也 可以 根据 开发 方 的 熟悉 程度 由 开发 方 选择 ， 但 基本 可以 限定 在 Linux 操作系统 。 　 　 对于 . Net 平台 下 的 Web 应用 ， 其 Web 服务器 必然选择 IIS ， 其 对应 的 操作系统 亦 为 WindowsServer 。 由于 Web 服务器 都 是 以 软件包 的 形式 存在 ， 其均 可以 通过 命令行 方式 安装 ， 因此 该项 没有 做进 虚拟机 模板 ， 而是 根据 实际 情况 实时 安装 。 　 　 4 . 建立 统一 的 日志 规范 规范 整个 系统 而 非微 服务 的 日志 体系 ， 采用 标准 的 日志 格式 非常 便于 后续 的 日志 聚合 检索 ， 便于 整体 的 视角 分析 、 监控 、 查看 系统 ； 一旦 系统 出现 问题 ， 运维 可以 提供 详实 的 日志 给 开发 方 ， 便于 问题 的 查找 和 解决 。 鉴于 不同 的 服务器 操作系统 有 不同 的 日志 系统 ， 因为 对于 虚拟机 准备 中 没有 特殊要求 。 但 也 可以 单独 准备 rsyslog 服务器 ， 用于 接收 从 Linux 服务器 发过来 的 日志 。 　 　 5 . 选择 成熟 框架 在 DevOps 中 ， 重复使用 某个 模块 是 该 模式 的 基础 。 必须 避免 自己 重复 发明 轮子 ， 尽量 选择 市面上 成熟 的 开源 技术 框架 进行 支撑 ， 比如 SpringBoot 、 SpringCloud 、 Netflix 、 WildFlySwarm 、 Docker 、 Kubernetes 、 Bootstrap 、 CAS 等 框架 ； 只有 如此 ， 才能 减少 DevOps 组 的 技术 负责 度 ， 降低 运维 人员 的 技术 要求 。 由于 使用 组件 的 重复性 ， 运 维和 开发人员 均 可以 充分 熟悉 所用 组件 框架 ， 从而 快速 发现 问题 、 解决问题 。 有 了 以上 的 要求 ， 我们 还 需要 建设 代码 共享 库 ， 问题 列表 库 、 文档 知识库 等 DevOps 所 必须 的 支撑 ， 而 这些 支撑 是 通过 云 计算 的 方式 来 提供 。 尤其 是 新 的 应用 系统 建设 时 ， DevOps 中 的 运维 人员 ， 即 校方 运维 人员 ， 可以 以 同样 的 架构 应用 于 新 的 应用 系统 建设 。 　 　 由此 我们 可以 总结 出如图 3 所示 的 云 计算 下 的 DevOps 开发 模式 拓扑图 。 ! [ ] ( . / W020161208674549726591 . jpg ) 在 该 拓扑 结构 下 ， 原有 私有 云运维 团队 中 ， 需要 提升 部分 工作人员 向 业务 层 发展 ， 并 控制代码 库 、 知识库 和 问题 库 的 部署 和 基本 运维 管理 。 在 新建 项目 时 ， 私有 云运维 团队 需要 根据 项目 需要 ， 分配 生产 环境 、 测试环境 和 开发 环境 给 项目组 ， 从而 允许 项目 多次 部署 、 多次 交付 。 在 云 计算环境 下 的 DevOps 要求 云 计算 运维 人员 不仅 是 云 基础架构 管理员 ， 还 需要 参与 到 项目组 中 ， 了解 项目 基本 信息 ， 因此 对于 云 计算 相关 人员 的 定位 提出 了 更 明晰 的 要求 。 引入 DevOps 机制 ， 可以 保障 软件 项目 的 有序 推荐 ， 保障 软件 项目 的 质量 。 　 　 （ 作者 单位 为 上海 海事 大学 ）